import { None, Some } from "../core/option";
import { emoji, resultToColor, resultToMarkdown } from "../util";
class TestCoverageConverter {
    convertHeader(header) {
        return this.convertTable(header).andThen((badge) => {
            if (header.data.type === "test-coverage") {
                const f = emoji(header.data.result);
                const h = `##### ${f}  ${header.name}\n`;
                const coverage = `
**Basic Coverage**: \\
| Type | Coverage |
| ---- | -------- |
| Line | ${header.data.line.toFixed(2)}% |
| Statement | ${header.data.statement.toFixed(2)}% |
| Function | ${header.data.function.toFixed(2)}% |
| Branch | ${header.data.branch.toFixed(2)}% |
`;
                const diff = header.data.delta;
                const dEmoji = (d) => (d > 0 ? "‚è´" : "‚è¨");
                const delta = diff == null
                    ? ""
                    : `**Change from base of PR**: \\
| Type | Coverage |
| ---- | -------- |
| Line | ${diff.line.toFixed(2)}% ${dEmoji(diff.line)} |
| Statement | ${diff.statement.toFixed(2)}% ${dEmoji(diff.statement)} |
| Function | ${diff.function.toFixed(2)}% ${dEmoji(diff.function)} |
| Branch | ${diff.branch.toFixed(2)}% ${dEmoji(diff.branch)} |
`;
                const policy = resultToMarkdown(header.data.resultDetails);
                return Some(`
${h}
Report: ${badge}
${coverage}
${delta}
${policy}
`);
            }
            return None();
        });
    }
    convertTable(table) {
        if (table.data.type === "test-coverage") {
            const color = resultToColor(table.data.result);
            const d = table.data;
            // ‚ò≤ 100% | ‚à¨ 90.2% | üúâ 25.5%
            return Some(`[![badge](https://img.shields.io/badge/coverage` +
                `-%E2%98%B2%20${d.statement.toFixed(1)}%25%20%7C%20%E2%88%AC%20${d.function.toFixed(1)}%25%20%7C%20%F0%9F%9C%89%20${d.branch.toFixed(1)}%25` +
                `-${color})](${table.url})`);
        }
        return None();
    }
}
export { TestCoverageConverter };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGVzdC1jb3ZlcmFnZS1jb252ZXJ0ZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvbGliL2NvbnZlcnRlci90ZXN0LWNvdmVyYWdlLWNvbnZlcnRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFFQSxPQUFPLEVBQUUsSUFBSSxFQUFVLElBQUksRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3BELE9BQU8sRUFBRSxLQUFLLEVBQUUsYUFBYSxFQUFFLGdCQUFnQixFQUFFLE1BQU0sU0FBUyxDQUFDO0FBRWpFLE1BQU0scUJBQXFCO0lBQ3pCLGFBQWEsQ0FBQyxNQUFtQjtRQUMvQixPQUFPLElBQUksQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsS0FBSyxFQUFFLEVBQUU7WUFDakQsSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksS0FBSyxlQUFlLEVBQUU7Z0JBQ3hDLE1BQU0sQ0FBQyxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO2dCQUNwQyxNQUFNLENBQUMsR0FBRyxTQUFTLENBQUMsS0FBSyxNQUFNLENBQUMsSUFBSSxJQUFJLENBQUM7Z0JBQ3pDLE1BQU0sUUFBUSxHQUFHOzs7O1dBSWQsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztnQkFDdEIsTUFBTSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztlQUNqQyxNQUFNLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO2FBQ2pDLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7Q0FDekMsQ0FBQztnQkFDTSxNQUFNLElBQUksR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQztnQkFDL0IsTUFBTSxNQUFNLEdBQUcsQ0FBQyxDQUFTLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztnQkFDbEQsTUFBTSxLQUFLLEdBQ1QsSUFBSSxJQUFJLElBQUk7b0JBQ1YsQ0FBQyxDQUFDLEVBQUU7b0JBQ0osQ0FBQyxDQUFDOzs7V0FHSCxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsS0FBSyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQztnQkFDckMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEtBQUssTUFBTSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUM7ZUFDckQsSUFBSSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEtBQUssTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUM7YUFDcEQsSUFBSSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEtBQUssTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUM7Q0FDMUQsQ0FBQztnQkFFTSxNQUFNLE1BQU0sR0FBRyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDO2dCQUMzRCxPQUFPLElBQUksQ0FBQztFQUNsQixDQUFDO1VBQ08sS0FBSztFQUNiLFFBQVE7RUFDUixLQUFLO0VBQ0wsTUFBTTtDQUNQLENBQUMsQ0FBQzthQUNJO1lBQ0QsT0FBTyxJQUFJLEVBQUUsQ0FBQztRQUNoQixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRCxZQUFZLENBQUMsS0FBa0I7UUFDN0IsSUFBSSxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksS0FBSyxlQUFlLEVBQUU7WUFDdkMsTUFBTSxLQUFLLEdBQUcsYUFBYSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDL0MsTUFBTSxDQUFDLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQztZQUNyQiw4QkFBOEI7WUFDOUIsT0FBTyxJQUFJLENBQ1QsaURBQWlEO2dCQUMvQyxnQkFBZ0IsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQ2pDLENBQUMsQ0FDRiwyQkFBMkIsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQzVDLENBQUMsQ0FDRiw4QkFBOEIsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEtBQUs7Z0JBQ3ZELElBQUksS0FBSyxNQUFNLEtBQUssQ0FBQyxHQUFHLEdBQUcsQ0FDOUIsQ0FBQztTQUNIO1FBQ0QsT0FBTyxJQUFJLEVBQUUsQ0FBQztJQUNoQixDQUFDO0NBQ0Y7QUFFRCxPQUFPLEVBQUUscUJBQXFCLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbnZlcnRlciB9IGZyb20gXCIuLi9pbnRlcmZhY2UvY29udmVydGVyXCI7XG5pbXBvcnQgeyBEYXRhRWxlbWVudCB9IGZyb20gXCIuLi9pbnB1dFwiO1xuaW1wb3J0IHsgTm9uZSwgT3B0aW9uLCBTb21lIH0gZnJvbSBcIi4uL2NvcmUvb3B0aW9uXCI7XG5pbXBvcnQgeyBlbW9qaSwgcmVzdWx0VG9Db2xvciwgcmVzdWx0VG9NYXJrZG93biB9IGZyb20gXCIuLi91dGlsXCI7XG5cbmNsYXNzIFRlc3RDb3ZlcmFnZUNvbnZlcnRlciBpbXBsZW1lbnRzIENvbnZlcnRlciB7XG4gIGNvbnZlcnRIZWFkZXIoaGVhZGVyOiBEYXRhRWxlbWVudCk6IE9wdGlvbjxzdHJpbmc+IHtcbiAgICByZXR1cm4gdGhpcy5jb252ZXJ0VGFibGUoaGVhZGVyKS5hbmRUaGVuKChiYWRnZSkgPT4ge1xuICAgICAgaWYgKGhlYWRlci5kYXRhLnR5cGUgPT09IFwidGVzdC1jb3ZlcmFnZVwiKSB7XG4gICAgICAgIGNvbnN0IGYgPSBlbW9qaShoZWFkZXIuZGF0YS5yZXN1bHQpO1xuICAgICAgICBjb25zdCBoID0gYCMjIyMjICR7Zn0gICR7aGVhZGVyLm5hbWV9XFxuYDtcbiAgICAgICAgY29uc3QgY292ZXJhZ2UgPSBgXG4qKkJhc2ljIENvdmVyYWdlKio6IFxcXFxcbnwgVHlwZSB8IENvdmVyYWdlIHxcbnwgLS0tLSB8IC0tLS0tLS0tIHxcbnwgTGluZSB8ICR7aGVhZGVyLmRhdGEubGluZS50b0ZpeGVkKDIpfSUgfFxufCBTdGF0ZW1lbnQgfCAke2hlYWRlci5kYXRhLnN0YXRlbWVudC50b0ZpeGVkKDIpfSUgfFxufCBGdW5jdGlvbiB8ICR7aGVhZGVyLmRhdGEuZnVuY3Rpb24udG9GaXhlZCgyKX0lIHxcbnwgQnJhbmNoIHwgJHtoZWFkZXIuZGF0YS5icmFuY2gudG9GaXhlZCgyKX0lIHxcbmA7XG4gICAgICAgIGNvbnN0IGRpZmYgPSBoZWFkZXIuZGF0YS5kZWx0YTtcbiAgICAgICAgY29uc3QgZEVtb2ppID0gKGQ6IG51bWJlcikgPT4gKGQgPiAwID8gXCLij6tcIiA6IFwi4o+sXCIpO1xuICAgICAgICBjb25zdCBkZWx0YSA9XG4gICAgICAgICAgZGlmZiA9PSBudWxsXG4gICAgICAgICAgICA/IFwiXCJcbiAgICAgICAgICAgIDogYCoqQ2hhbmdlIGZyb20gYmFzZSBvZiBQUioqOiBcXFxcXG58IFR5cGUgfCBDb3ZlcmFnZSB8XG58IC0tLS0gfCAtLS0tLS0tLSB8XG58IExpbmUgfCAke2RpZmYubGluZS50b0ZpeGVkKDIpfSUgJHtkRW1vamkoZGlmZi5saW5lKX0gfFxufCBTdGF0ZW1lbnQgfCAke2RpZmYuc3RhdGVtZW50LnRvRml4ZWQoMil9JSAke2RFbW9qaShkaWZmLnN0YXRlbWVudCl9IHxcbnwgRnVuY3Rpb24gfCAke2RpZmYuZnVuY3Rpb24udG9GaXhlZCgyKX0lICR7ZEVtb2ppKGRpZmYuZnVuY3Rpb24pfSB8XG58IEJyYW5jaCB8ICR7ZGlmZi5icmFuY2gudG9GaXhlZCgyKX0lICR7ZEVtb2ppKGRpZmYuYnJhbmNoKX0gfFxuYDtcblxuICAgICAgICBjb25zdCBwb2xpY3kgPSByZXN1bHRUb01hcmtkb3duKGhlYWRlci5kYXRhLnJlc3VsdERldGFpbHMpO1xuICAgICAgICByZXR1cm4gU29tZShgXG4ke2h9XG5SZXBvcnQ6ICR7YmFkZ2V9XG4ke2NvdmVyYWdlfVxuJHtkZWx0YX1cbiR7cG9saWN5fVxuYCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gTm9uZSgpO1xuICAgIH0pO1xuICB9XG5cbiAgY29udmVydFRhYmxlKHRhYmxlOiBEYXRhRWxlbWVudCk6IE9wdGlvbjxzdHJpbmc+IHtcbiAgICBpZiAodGFibGUuZGF0YS50eXBlID09PSBcInRlc3QtY292ZXJhZ2VcIikge1xuICAgICAgY29uc3QgY29sb3IgPSByZXN1bHRUb0NvbG9yKHRhYmxlLmRhdGEucmVzdWx0KTtcbiAgICAgIGNvbnN0IGQgPSB0YWJsZS5kYXRhO1xuICAgICAgLy8g4piyIDEwMCUgfCDiiKwgOTAuMiUgfCDwn5yJIDI1LjUlXG4gICAgICByZXR1cm4gU29tZShcbiAgICAgICAgYFshW2JhZGdlXShodHRwczovL2ltZy5zaGllbGRzLmlvL2JhZGdlL2NvdmVyYWdlYCArXG4gICAgICAgICAgYC0lRTIlOTglQjIlMjAke2Quc3RhdGVtZW50LnRvRml4ZWQoXG4gICAgICAgICAgICAxXG4gICAgICAgICAgKX0lMjUlMjAlN0MlMjAlRTIlODglQUMlMjAke2QuZnVuY3Rpb24udG9GaXhlZChcbiAgICAgICAgICAgIDFcbiAgICAgICAgICApfSUyNSUyMCU3QyUyMCVGMCU5RiU5QyU4OSUyMCR7ZC5icmFuY2gudG9GaXhlZCgxKX0lMjVgICtcbiAgICAgICAgICBgLSR7Y29sb3J9KV0oJHt0YWJsZS51cmx9KWBcbiAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiBOb25lKCk7XG4gIH1cbn1cblxuZXhwb3J0IHsgVGVzdENvdmVyYWdlQ29udmVydGVyIH07XG4iXX0=